{% extends 'nav.html' %}
{% load static %}
{% block content %}
<html>
  <head>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  </head>
  <body>
    <div class="" style="margin-top: 80px;"></div>
    <div class="bg-gray-100 min-h-screen pt-8 pb-20">
      <div class="container mx-auto px-4">
        <h1 class="text-4xl font-bold text-center text-gray-800 mb-10">ğŸ“‘ All Tender Listings</h1>

        {% if tenders %}
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            {% for t in tenders %}
              <div class="bg-white rounded-2xl shadow hover:shadow-lg transition p-6 relative">
                
                <div class="absolute top-4 right-4 text-xs bg-blue-100 text-blue-600 px-3 py-1 rounded-full">
                  Deadline: {{ t.deadline }}
                </div>

                <h2 class="text-xl font-semibold text-gray-900 mb-2">{{ t.title }}</h2>
                <p class="text-gray-600 text-sm mb-2">{{ t.description|truncatechars:180 }}</p>

                <div class="text-sm text-gray-700 space-y-1 mt-2">
                  <p><strong>ğŸ“ Location:</strong> {{ t.location }}</p>
                  <p><strong>ğŸ¢ Industry:</strong> {{ t.industry_type }}</p>
                  <p><strong>ğŸ“‚ Type:</strong> {{ t.tender_type }}</p>
                  {% if t.eligibility %}
                    <p><strong>âœ… Eligibility:</strong> {{ t.eligibility }}</p>
                  {% endif %}
                </div>

                <div class="mt-3 text-sm text-gray-700 space-y-1">
                  <p><strong>ğŸ‘¤ Contact:</strong> {{ t.contact_person }}</p>
                  <p><strong>ğŸ“§ Email:</strong> {{ t.contact_email }}</p>
                  <p><strong>ğŸ“ Phone:</strong> {{ t.contact_phone }}</p>
                  {% if t.terms_file %}
                    <p><strong>ğŸ“ Terms:</strong> <a href="{{ t.terms_file.url }}" class="text-blue-600 underline" target="_blank">Download PDF</a></p>
                  {% endif %}
                </div>

                <div class="flex items-center justify-between mt-5">
                  <span class="text-green-600 font-bold text-lg">â‚¹{{ t.budget }}</span>

                  {% if request.session.cp_email %}
                    {% if t.company.cp_email == request.session.cp_email %}
                      <span class="text-sm text-gray-500 italic">âœ… You posted this</span>
                    {% else %}
                      <a href="{% url 'apply_tender' t.id %}" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 text-sm font-medium">Apply</a>
                    {% endif %}
                  {% else %}
                    <a href="{% url 'login' %}" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 text-sm font-medium">Login to Apply</a>
                  {% endif %}
                </div>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <div class="text-center mt-24">
            <img src="https://cdn-icons-png.flaticon.com/512/2748/2748558.png" class="mx-auto w-28">
            <p class="text-2xl font-semibold mt-6 text-gray-700">No tenders available right now.</p>
            <p class="text-gray-500 mt-2">Check back again soon for new opportunities!</p>
          </div>
        {% endif %}

        <!-- ğŸ” View Buttons -->
        <div class="text-center mt-12 space-x-4">
          <a href="{% url 'tender_list' %}?your=true"
            class="px-5 py-2 rounded transition 
            {% if your_tenders %}bg-blue-600 text-white{% else %}bg-gray-200 text-gray-800 hover:bg-gray-300{% endif %}">
            ğŸ“‚ View Your Tenders
          </a>
          <a href="{% url 'tender_list' %}"
            class="px-5 py-2 rounded transition 
            {% if not your_tenders %}bg-blue-600 text-white{% else %}bg-gray-200 text-gray-800 hover:bg-gray-300{% endif %}">
            ğŸ” View All Tenders
          </a>
        </div>
      </div>
    </div>
  </body>
</html>
{% endblock %}
